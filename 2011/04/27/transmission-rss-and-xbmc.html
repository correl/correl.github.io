<!doctype html>
<html lang="en-us">
  <head>
    <title>Transmission, RSS, and XBMC // Projects and Coding Adventures</title>
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.105.0">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Correl Roush" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="https://correl.phoenixinquis.net/css/main.min.86d08b4bb3efd338b408a5c3ba02c2f37aa024dbec7f62531aae2f9a7c0aa6da.css" />

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-429788-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Transmission, RSS, and XBMC"/>
<meta name="twitter:description" content="I&rsquo;m a huge fan of XBMC. My pc (currently running Ubuntu 10.04) has taken root in my
living room, piping all my movies and tv shows straight to my HDTV.
While my pc is set up as a DVR using MythTV to record shows off my FIOS box, it tends to be a little unreliable, which can suck when it&rsquo;s time to catch up on Daily Show and Colbert episodes.
I&rsquo;ve had Transmission set up for a while for all my torrenting needs, and
I&rsquo;ve even written an XBMC script to manage torrents, so I got to looking for
tools to track tv show torrent rss feeds."/>

    <meta property="og:title" content="Transmission, RSS, and XBMC" />
<meta property="og:description" content="I&rsquo;m a huge fan of XBMC. My pc (currently running Ubuntu 10.04) has taken root in my
living room, piping all my movies and tv shows straight to my HDTV.
While my pc is set up as a DVR using MythTV to record shows off my FIOS box, it tends to be a little unreliable, which can suck when it&rsquo;s time to catch up on Daily Show and Colbert episodes.
I&rsquo;ve had Transmission set up for a while for all my torrenting needs, and
I&rsquo;ve even written an XBMC script to manage torrents, so I got to looking for
tools to track tv show torrent rss feeds." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://correl.phoenixinquis.net/2011/04/27/transmission-rss-and-xbmc.html" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2011-04-27T00:01:00-04:00" />
<meta property="article:modified_time" content="2011-04-27T00:01:00-04:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="https://correl.phoenixinquis.net/"><img class="app-header-avatar" src="/avatar.jpg" alt="Correl Roush" /></a>
      <h1>Correl Roush</h1>
      <p>Transgender ・ MtF ・ Genderfluid ・ She/Her</p>
      <div class="app-header-social">
        
          <a target="_blank" href="https://twitter.com/correlr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg></a>
        
          <a target="_blank" href="https://github.com/correl"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg></a>
        
          <a target="_blank" href="https://www.instagram.com/correlroush/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-instagram">
  <title>instagram</title>
  <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"></line>
</svg></a>
        
      </div>
      <p>
          <a href="/files/resume.pdf"> 
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-download">
  <title>download</title>
  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line>
</svg>
              Download Résumé
          </a>
      </p>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Transmission, RSS, and XBMC</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Apr 27, 2011
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          3 min read
        </div><div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line>
</svg>
          <a class="tag" href="https://correl.phoenixinquis.net/tags/programming.html">programming</a><a class="tag" href="https://correl.phoenixinquis.net/tags/python.html">python</a></div></div>
    </header>
    <div class="post-content">
      <p>I&rsquo;m a huge fan of <a href="http://www.xbmc.org/">XBMC</a>. My pc (currently running Ubuntu 10.04) has taken root in my
living room, piping all my movies and tv shows straight to my HDTV.</p>
<p>While my pc is set up as a DVR using <a href="http://www.mythtv.org">MythTV</a> to record shows off my FIOS box, it tends to be a little unreliable, which can suck when it&rsquo;s time to catch up on Daily Show and Colbert episodes.
I&rsquo;ve had <a href="http://www.transmissionbt.com/">Transmission</a> set up for a while for all my torrenting needs, and
I&rsquo;ve even written an <a href="https://github.com/correl/Transmission-XBMC">XBMC script to manage torrents</a>, so I got to looking for
tools to track tv show torrent rss feeds.</p>
<p>My first stop was <a href="http://ted.nu/">TED</a>. TED worked well enough, but would occasionally hang.
Since it&rsquo;s a GUI java app running in the taskbar, it would require me to dig
out my mouse and break out of full screen XBMC to fiddle with it. I eventually
got tired of dealing with TED and went back to prodding Myth.</p>
<p>Recently I&rsquo;ve been itching to reliably watch my shows again, so I checked around
for a simple command-line utility to track rss feeds and download torrents.
Finding none, I loaded up vim and threw together a python script to handle it
all for me.</p>
<p>I also have another, simple script from when I was using TED (or just manually
downloading shows) which looks at completed torrents, compares their names with
the folders in my TV directory, and moves the shows into them for XBMC to see.</p>
<p>A couple cron jobs and a few rss feeds later, and I&rsquo;ve got all my shows
automatically delivered straight to XBMC for my lazy evening viewing pleasure.</p>
<h3 id="trsspy">trss.py</h3>
<p><a href="https://github.com/correl/trss/raw/master/trss.py">Download</a></p>
<pre tabindex="0"><code>Usage:
    trss.py add &lt;rss-url&gt; [&lt;recent-items&gt;]
        Adds an RSS feed to follow
        rss-url:        Full URL to the RSS feed
        recent-items:   (Optional) number of recent items to queue
                        for downloading
    trss.py remove &lt;index&gt;
        Remove an RSS feed
        index:          Numeric index of the feed to remove as
                        reported by the list command
    trss.py list
        Displays a list of followed feeds

    trss.py download
        Fetch all feeds and download new items

    trss.py set [&lt;setting&gt; [&lt;value&gt;]]
        Set or view configuration settings
        Call without any arguments to list all settings and their values
        Call with a setting and no value to see the current value for that setting

        Currently, the only used setting is &#39;download_dir&#39;, which allows you to set
        a directory to store all retrieved torrents, such as a directory your
        torrent application watches for new downloads. If &#39;download_dir&#39; is not set,
        the current directory will be used.
</code></pre><h3 id="transmission-tvpy">transmission-tv.py</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/python</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> transmissionrpc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TV_PATH <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/media/Gaia/Video/TV/&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TVShowCollection</span>:
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">def</span> __init__(self, path):
</span></span><span style="display:flex;"><span>		self<span style="color:#f92672">.</span>path <span style="color:#f92672">=</span> path
</span></span><span style="display:flex;"><span>		self<span style="color:#f92672">.</span>shows <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>listdir(path)
</span></span><span style="display:flex;"><span>		self<span style="color:#f92672">.</span>patterns <span style="color:#f92672">=</span> [[s<span style="color:#f92672">.</span>lower()<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39; &#39;</span>, <span style="color:#e6db74">&#39;.?&#39;</span>), s] <span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> sorted(self<span style="color:#f92672">.</span>shows, key<span style="color:#f92672">=</span>len, reverse<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)]
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">match</span>(self, filename):
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span> pattern, show <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>patterns:
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">if</span> re<span style="color:#f92672">.</span>findall(pattern, filename<span style="color:#f92672">.</span>lower()):
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">return</span> show
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">move</span>(self, ids, location):
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;&#34;&#34;Move torrent data to the new location.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>	self<span style="color:#f92672">.</span>_rpc_version_warning(<span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>	args <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;location&#39;</span>: location, <span style="color:#e6db74">&#39;move&#39;</span>: <span style="color:#66d9ef">True</span>}
</span></span><span style="display:flex;"><span>	self<span style="color:#f92672">.</span>_request(<span style="color:#e6db74">&#39;torrent-set-location&#39;</span>, args, ids, <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> float(transmissionrpc<span style="color:#f92672">.</span>__version__) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.4</span>:
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># The move function is not present in versions 0.3 and older</span>
</span></span><span style="display:flex;"><span>	transmissionrpc<span style="color:#f92672">.</span>Client<span style="color:#f92672">.</span>move <span style="color:#f92672">=</span> move
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>collection <span style="color:#f92672">=</span> TVShowCollection(TV_PATH)
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> transmissionrpc<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>torrents <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, torrent <span style="color:#f92672">in</span> torrents<span style="color:#f92672">.</span>iteritems():
</span></span><span style="display:flex;"><span>	status <span style="color:#f92672">=</span> torrent<span style="color:#f92672">.</span>status
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> status <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#39;seeding&#39;</span>, <span style="color:#e6db74">&#39;stopped&#39;</span>]:
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>	show <span style="color:#f92672">=</span> collection<span style="color:#f92672">.</span>match(torrent<span style="color:#f92672">.</span>name)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> show <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>	path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{0}{1}</span><span style="color:#e6db74">/&#39;</span><span style="color:#f92672">.</span>format(TV_PATH, show)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> torrent<span style="color:#f92672">.</span>downloadDir<span style="color:#f92672">.</span>startswith(path):
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>	print <span style="color:#e6db74">&#39;Found </span><span style="color:#e6db74">{0}</span><span style="color:#e6db74"> torrent </span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">{1}</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74"> in show </span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">{2}</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">, moving...&#39;</span><span style="color:#f92672">.</span>format(status, torrent<span style="color:#f92672">.</span>name, show)
</span></span><span style="display:flex;"><span>	result <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>move(i, path)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> status <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;seeding&#39;</span>:
</span></span><span style="display:flex;"><span>		print <span style="color:#e6db74">&#39;Re-starting torrent to continue seeding&#39;</span>
</span></span><span style="display:flex;"><span>		client<span style="color:#f92672">.</span>start(i)
</span></span></code></pre></div>
    </div>
    <div class="post-footer">
      <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "correl" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </article>

    </main>
  </body>
</html>
